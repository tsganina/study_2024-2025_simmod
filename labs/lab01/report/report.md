---
## Front matter
title: "Отчёт по лабораторной работе №1"
subtitle: "Дисциплина: Имитационное моделирование"
author: "Ганина Таисия Сергеевна, НФИбд-01-22"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Целью данной работы является приобретение навыков моделирования сетей передачи данных с помощью средства имитационного моделирования NS-2, а также анализ полученных результатов моделирования.

# Задание

1. Записать шаблон сценария для NS-2.
2. Создать простой пример описания топологии сети, состоящей из двух узлов и одного соединения.
3. Создать пример с усложнённой топологией сети.
4. Создать пример с кольцевой топологией сети.
5. Выполнить упражнение.


# Выполнение лабораторной работы

1. Я создала в рабочем каталоге директорию mip, к которой будут выполняться лабораторные работы. Внутри mip создала директорию lab-ns, а в ней файл shablon.tcl. Открыла файл шаблона на редактирование и заполнила его согласно коду из задания лабораторной. После этого запустила шаблон и посмотрела на результат. Пустой экран приложения, где, редактируя шаблон, в будущем мы будем добавлять сети определенных топологий.
(рис. @fig:001, @fig:002, @fig:003).

![Создание файлов](image/1.png){#fig:001 width=70%}

![Заполнение файла шаблона](image/2.png){#fig:002 width=70%}

![Результат выполнения файла шаблона, приложение](image/3.png){#fig:003 width=70%}


2. Я выполнила по образцу из задания лабораторной простой пример описания топологии сети, состоящей из двух
узлов и одного соединения. В начале скопировала содержимое шаблона в новый файл, после отредактировала его. Добавила описание топологии сети, создала агенты для генерации и приема трафика, создала агент UDP и присоединила к узлу n0. В узле агент сам не может генерировать трафик, он лишь реализует протоколы и алгоритмы транспортного уровня. Поэтому к агенту присоединяется приложение. В данном случае — это источник с постоянной скоростью (Constant Bit Rate, CBR), который каждые 5 мс посылает пакет R = 500 байт. (рис. @fig:004, @fig:005, @fig:006, @fig:007, @fig:008).

![Копирование шаблона](image/4.png){#fig:004 width=70%}

![Код программы](image/5.png){#fig:005 width=70%}

![Аниматор nam](image/6.png){#fig:006 width=70%}

![Визуализация простой модели сети с помощью nam](image/7.png){#fig:007 width=70%}

![Можно осуществлять наблюдение за отдельным пакетом, щёлкнув по нему в окне nam](image/8.png){#fig:008 width=70%}


3. Пример с усложнённой топологией сети. Точно также скопировала шаблон и заполнила его, прочитав постановку задачи. Обнаружила неточности в коде, который предлагается в качестве примера в лабораторной работе, исправила их.
- Задание: "– между узлами n2 и n3 установлено дуплексное соединение с пропускной способностью 1,7 Мбит/с и задержкой 20 мс;"
- Код: `$ns duplex-link $n(3) $n(2) 2Mb 10ms DropTail`.
- Заменила 2 на 1.7 и 10 на 20.

Далее:
- Задание: "работа cbr начинается в 0,1 секунду и прекращается в 4,5 секунды, а ftp начинает работать в 1,0 секунду и прекращает в 4,0 секунды."
- Код: `$ns at 0.5 "$cbr0 start"`.
- Заменила 0.5 на 0.1.

Сохранив изменения в отредактированном файле и запустив симулятор, получила анимированный результат моделирования.
(рис. @fig:009, @fig:010, @fig:011, @fig:012, @fig:013).

![Кадр с неточностью](image/9.png){#fig:009 width=70%}

![Код программы](image/10.png){#fig:010 width=70%}

![Продолжение кода](image/11.png){#fig:011 width=70%}

![До запуска анимации, вид на топологию](image/12.png){#fig:012 width=70%}

![Выполнение моделирование, анимация](image/13.png){#fig:013 width=70%}

4. Пример с кольцевой топологией сети. Я опять переписала код, в данном примере данные должны передаваться по кратчайшему маршруту, а при разрыве соединения информация о топологии должна обновляться и пакеты отсылаться по новому маршруту. После восстановления соединения снова будет выбран самый короткий маршрут. (рис. @fig:014, @fig:015, @fig:016, @fig:017, @fig:018).

![Текст скрипта, измененный шаблон](image/14.png){#fig:014 width=70%}

![Кратчайший маршрут до разрыва соединения](image/15.png){#fig:015 width=70%}

![Момент разрыва соединения](image/16.png){#fig:016 width=70%}

![Резервный маршрут через узлы n(6), n(5) и n(4)](image/17.png){#fig:017 width=70%}

![Сообщения в терминале о разрыве и восстановлении](image/18.png){#fig:018 width=70%}

5. Упражнение. Я внесла следующие изменения в реализацию примера с кольцевой топологией сети:
- топология сети должна соответствовать представленной в лабораторной.
- передача данных должна осуществляться от узла n(0) до узла n(5) по кратчайшему пути в течение 5 секунд модельного времени;
- передача данных должна идти по протоколу TCP (тип Newreno), на принимающей стороне используется TCPSink-объект типа DelAck; поверх TCP работает протокол FTP с 0,5 до 4,5 секунд модельного времени;
- с 1 по 2 секунду модельного времени происходит разрыв соединения между
узлами n(0) и n(1);
- при разрыве соединения маршрут передачи данных должен измениться на резервный, после восстановления соединения пакеты снова должны пойти по
кратчайшему пути.
(рис. @fig:019, @fig:020, @fig:021, @fig:022, @fig:023, @fig:024).

![Топология сети](image/19.png){#fig:019 width=70%}

![Передача данных до разрыва соединения между 0 и 1 узлами](image/20.png){#fig:020 width=70%}

![Передача после разрыва соединения и обновления маршрута](image/21.png){#fig:021 width=70%}

![Передача данных после восстановления соединения между 0 и 1 узлами](image/22.png){#fig:022 width=70%}

![Сообщения в терминале](image/23.png){#fig:023 width=70%}

![Вид скрипта упражнения](image/24.png){#fig:024 width=70%}

6. Листинг упражнения:

```
# создание объекта Simulator
set ns [new Simulator]
$ns rtproto DV

# открытие на запись файла out.nam для визуализатора nam
set nf [open out.nam w]

# все результаты моделирования будут записаны в переменную nf
$ns namtrace-all $nf

# открытие на запись файла трассировки out.tr
# для регистрации всех событий
set f [open out.tr w]

# все регистрируемые события будут записаны в переменную f
$ns trace-all $f

# процедура finish закрывает файлы трассировки
# и запускает визуализатор nam
proc finish {} {
    global ns f nf # объявление глобальных переменных
    # запуск nam в фоновом режиме
    close $f
    close $nf
    exec nam out.nam &
    exit 0
}

set N 5
for {set i 0} {$i < $N} {incr i} {
set n($i) [$ns node]
}

for {set i 0} {$i < $N} {incr i} {
$ns duplex-link $n($i) $n([expr ($i+1)%$N]) 1Mb 10ms DropTail
}

set n(5) [$ns node]
$ns duplex-link $n(5) $n(1) 1Mb 10ms DropTail

set tcp1 [new Agent/TCP]
$ns attach-agent $n(0) $tcp1

set ftp [new Application/FTP]
$ftp attach-agent $tcp1

set sink1 [new Agent/TCPSink/DelAck]
$ns attach-agent $n(5) $sink1

$ns connect $tcp1 $sink1


$ns at 0.5 "$ftp start"
$ns rtmodel-at 1.0 down $n(0) $n(1)
$ns rtmodel-at 2.0 up $n(0) $n(1)
$ns at 4.5 "$ftp stop"

# at-событие для планировщика событий, которое запускает
# процедуру finish через 5 с после начала моделирования
$ns at 5.0 "finish"

# запуск модели
$ns run
```

# Выводы

В ходе данной работы я приобрела практические навыки моделирования сетей передачи данных с помощью средства имитационного моделирования NS-2, а также выполнила анализ полученных результатов моделирования.

# Список литературы{.unnumbered}

1. [Руководство к лабораторной работе](https://esystem.rudn.ru/mod/resource/view.php?id=1223329)

::: {#refs}
:::

